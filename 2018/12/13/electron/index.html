<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content="没事儿,tong-h,Tong-H,tong-h blog"><meta name="descriptioon" content="personal blog by tong/没事儿"><meta name="renderer" content="wekit"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/css/public.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/iconfont.css"><title>Electron踩坑指南不完全篇 [ 没事儿 ]</title><link rel="stylesheet" href="/css/partial/footer.css"><link rel="stylesheet" href="/css/partial/sidebar.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"></head><body class="scroll"><link rel="stylesheet" href="/css/partial/header.css"><div class="header"><div class="maxwidth"><div class="nav"><a id="artlist" href="/404"><i class="iconfont icon404"></i><span class="headhid">&nbsp;404</span></a><a id="artlist" href="/archives"><i class="iconfont iconarchives"></i><span class="headhid">&nbsp;博 客</span></a><a id="artlist" href="/about"><i class="iconfont iconabout"></i><span class="headhid">&nbsp;关 于</span></a><a id="artlist" href="/link"><i class="iconfont iconlink"></i><span class="headhid">&nbsp;友 链</span></a></div><div class="search">It's more tiring to stop</div></div></div><div class="line"></div><div class="main"> <div class="maxwidth"><link rel="stylesheet" href="/css/partial/sidebar.css"><div id="sidebar"><div class="info"><a href="/"><img src="/images/user.png" alt="头像"></a><div><p>没事儿</p></div></div><div class="social"><a href="/archives" title="Home"><i class="iconfont iconHome"></i></a><a href="/atom.xml" title="RSS 源订阅"><i class="iconfont iconsubscribe-1-copy"></i></a><a href="mailto:tongt0232@gmail.com" title="E-Mail"><i class="iconfont iconweibiaoti554"></i></a><a href="https://github.com/tong-h" title="GitHub"><i class="iconfont iconGitHub"></i></a><a href="https://www.jianshu.com/u/20de04cc53de" title="简书"><img src="/images/jianicon-sidebar.png"></a></div><div class="structure category-list"><p>文章目录</p><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#为什么用Electron"><span class="toc-number">1.</span> <span class="toc-text">为什么用Electron</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#简单介绍"><span class="toc-number">2.</span> <span class="toc-text">简单介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#暗-坑"><span class="toc-number">3.</span> <span class="toc-text">暗 坑</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、已经引了BrowserWindow-为什么使用函数会是undefined？"><span class="toc-number">3.1.</span> <span class="toc-text">Q、已经引了BrowserWindow 为什么使用函数会是undefined？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、想在渲染进程使用主进程的api？"><span class="toc-number">3.2.</span> <span class="toc-text">Q、想在渲染进程使用主进程的api？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、单击PDF文件的链接时，Electron会提示下载而非直接预览？"><span class="toc-number">3.3.</span> <span class="toc-text">Q、单击PDF文件的链接时，Electron会提示下载而非直接预览？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、动态的修改静态文件的路径会报链接404？"><span class="toc-number">3.4.</span> <span class="toc-text">Q、动态的修改静态文件的路径会报链接404？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、透明窗口无效？"><span class="toc-number">3.5.</span> <span class="toc-text">Q、透明窗口无效？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、新建一个窗口，然后拖动该窗口，宽度和高度会小于指定值？"><span class="toc-number">3.6.</span> <span class="toc-text">Q、新建一个窗口，然后拖动该窗口，宽度和高度会小于指定值？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、navigator-mediaDevices-getUserMedia-使用该属性报错？"><span class="toc-number">3.7.</span> <span class="toc-text">Q、navigator.mediaDevices.getUserMedia 使用该属性报错？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、打包问题？"><span class="toc-number">3.8.</span> <span class="toc-text">Q、打包问题？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、’-’和’-‘符号路径问题"><span class="toc-number">3.9.</span> <span class="toc-text">Q、’\’和’/‘符号路径问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Q、关于新建窗口时的白屏"><span class="toc-number">3.10.</span> <span class="toc-text">Q、关于新建窗口时的白屏</span></a></li></ol></li></ol></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/MYSQL/">MYSQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PYTHON/">PYTHON</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RESTS/">RESTS</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SERVER/">SERVER</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TOOL/">TOOL</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/">WEB</a><span class="category-list-count">23</span></li></ul><div class="tags"><a href="/tags/ECharts/" style="font-size: 14px; color: #ffac00">ECharts</a> <a href="/tags/Electron/" style="font-size: 14px; color: #ffac00">Electron</a> <a href="/tags/JSON/" style="font-size: 14px; color: #ffac00">JSON</a> <a href="/tags/angular/" style="font-size: 18px; color: #ec9d00">angular</a> <a href="/tags/canvas/" style="font-size: 26px; color: #c77e00">canvas</a> <a href="/tags/cordova/" style="font-size: 30px; color: #b46e00">cordova</a> <a href="/tags/domain/" style="font-size: 14px; color: #ffac00">domain</a> <a href="/tags/ffmpeg/" style="font-size: 14px; color: #ffac00">ffmpeg</a> <a href="/tags/git/" style="font-size: 14px; color: #ffac00">git</a> <a href="/tags/hexo/" style="font-size: 22px; color: #da8d00">hexo</a> <a href="/tags/http/" style="font-size: 14px; color: #ffac00">http</a> <a href="/tags/markdown/" style="font-size: 14px; color: #ffac00">markdown</a> <a href="/tags/mpvue/" style="font-size: 14px; color: #ffac00">mpvue</a> <a href="/tags/mysql/" style="font-size: 14px; color: #ffac00">mysql</a> <a href="/tags/nginx/" style="font-size: 14px; color: #ffac00">nginx</a> <a href="/tags/nodejs/" style="font-size: 14px; color: #ffac00">nodejs</a> <a href="/tags/npm/" style="font-size: 14px; color: #ffac00">npm</a> <a href="/tags/python/" style="font-size: 14px; color: #ffac00">python</a> <a href="/tags/rests/" style="font-size: 14px; color: #ffac00">rests</a> <a href="/tags/search/" style="font-size: 14px; color: #ffac00">search</a> <a href="/tags/server/" style="font-size: 14px; color: #ffac00">server</a> <a href="/tags/vue/" style="font-size: 14px; color: #ffac00">vue</a> <a href="/tags/yarn/" style="font-size: 14px; color: #ffac00">yarn</a> <a href="/tags/原型链/" style="font-size: 14px; color: #ffac00">原型链</a> <a href="/tags/死磕英语/" style="font-size: 14px; color: #ffac00">死磕英语</a> <a href="/tags/缓存/" style="font-size: 14px; color: #ffac00">缓存</a> <a href="/tags/网络爬虫/" style="font-size: 18px; color: #ec9d00">网络爬虫</a> <a href="/tags/跨域/" style="font-size: 14px; color: #ffac00">跨域</a></div></div><div class="post rightside"><div class="artititle">Electron踩坑指南不完全篇</div><div class="info"><i class="iconfont iconchakan" title="本文阅读量"><span id="busuanzi_container_page_pv">  <span id="busuanzi_value_page_pv"></span> </span></i><i class="iconfont iconwenzi" title="字数">1.8k</i><i class="iconfont iconweibiaoti--" title="阅读时长">6</i><i class="iconfont iconarchives" title="文章分类"><span>WEB</span></i><i class="iconfont iconbiaoqian" title="文章标签"><span>Electron</span></i><i class="iconfont iconshijian"><span title="文章发布时间">2018-12-13</span><span>&emsp;</span><span title="文章更新时间">2019-02-26</span></i></div><div class="postDetail"><p>前段时间做了个客户端的项目，主要适用于老师教案管理、远程上课录屏、和学生互动答疑等场景，原生开发对公司来说成本有点大，基于guthub上有各种桌面打包框架so只能前端上了</p>
<p>Electron + vue = product</p>
<p>这是一篇踩坑的记录，没有太深入的原理什么的讲解，主要是码代码过程中碰到的一些暗坑你如果正在写Electron的项目那么你也可能会遇到，这篇文章会给你一些参考</p>
<h1 id="为什么用Electron"><a href="#为什么用Electron" class="headerlink" title="为什么用Electron"></a>为什么用Electron</h1><p>这是目前大家知道比较多的三种跨平台的桌面框架<br>NWJS      <a href="https://nwjs.io/" target="_blank" rel="noopener">https://nwjs.io/</a><br>HEX       <a href="http://hex.youdao.com/zh-cn/tutorial/index.html" target="_blank" rel="noopener">http://hex.youdao.com/zh-cn/tutorial/index.html</a><br>Electron  <a href="https://Electronjs.org/docs" target="_blank" rel="noopener">https://Electronjs.org/docs</a></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"><strong> Electron </strong></th>
<th style="text-align:center"><strong> nw.js </strong></th>
<th style="text-align:center"><strong> hex </strong>  </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"> <strong> 发布时间 </strong></td>
<td style="text-align:center">2013年</td>
<td style="text-align:center">2011年</td>
<td style="text-align:center">2012年 </td>
</tr>
<tr>
<td style="text-align:center"> <strong> 开发公司 </strong></td>
<td style="text-align:center">github</td>
<td style="text-align:center">intel</td>
<td style="text-align:center">有道翻译 </td>
</tr>
<tr>
<td style="text-align:center"> <strong> 代表作 </strong></td>
<td style="text-align:center">Atom、Visual Studio Code 、WordPress</td>
<td style="text-align:center">微信web开发工具、钉钉</td>
<td style="text-align:center">有道云笔记，有道词典</td>
</tr>
<tr>
<td style="text-align:center"> <strong> github start </strong></td>
<td style="text-align:center">66608</td>
<td style="text-align:center">34555</td>
<td style="text-align:center">1429 </td>
</tr>
</tbody>
</table>
<p>三个框架都是 chromium + nodejs + native api ， 不用考虑浏览器兼容性还能用nodejs，简直不要太爽</p>
<ul>
<li>Chromium 是 Google 为发展 Chrome 浏览器而启动的开源项目，它对HTML5的支持非常优秀，其内嵌的V8引擎是业内效率最好的JavaScript脚本引擎之一，且其项目开源，又有专门的社区和团队维护，作为UI渲染引擎，它是不二之选，体验上，你可以试用下google chrome浏览器，基本一致</li>
<li>Node.js （或者简称 Node） 一个工具，选择Node.JS，是因为开发桌面应用，本地资源操作是必备的能力，这方面JavaScript无能为力，而Node.JS则很好的解决了这个问题，它使得JavaScript操作本地资源变的毫无障碍。另一方面，Node.JS核心也是采用V8引擎，使得其与Chromium的整合变得更顺理成章</li>
<li>API 应用程序接口描述了一系列可供你使用的函数库中的函数</li>
</ul>
<p>我绝对是有道词典的忠实用户但是hex用的人较少怕遇坑爬不出来，nwjs主要优点是能兼容winXP，但是我不需要。。。而且nw和Electron是同一个大佬一前一后开发，Electron相当于是nwjs的重构升级版，官网又这么好看又那么火，还犹豫？</p>
<h1 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h1><p>官网传送门</p>
<ul>
<li>官方api <a href="https://Electronjs.org/docs" target="_blank" rel="noopener">https://Electronjs.org/docs</a></li>
<li>Electron-vue文档 <a href="https://simulatedgreg.gitbooks.io/Electron-vue/content/cn/getting_started.html" target="_blank" rel="noopener">https://simulatedgreg.gitbooks.io/Electron-vue/content/cn/getting_started.html</a></li>
<li>中文社区文档<a href="https://Electron.org.cn/doc/index.html" target="_blank" rel="noopener">https://Electron.org.cn/doc/index.html</a></li>
</ul>
<p>常用的一些模块：</p>
<ul>
<li>文件打开删除等操作 shell模块  <a href="https://Electronjs.org/docs/api/shell" target="_blank" rel="noopener">https://Electronjs.org/docs/api/shell</a></li>
<li>窗口管理修改新建参数等 BrowserWindow模块  <a href="https://Electronjs.org/docs/api/browser-window" target="_blank" rel="noopener">https://Electronjs.org/docs/api/browser-window</a></li>
<li>主进程和渲染进程通信 ipcRenderer 模块   <a href="https://Electronjs.org/docs/api/ipc-renderer" target="_blank" rel="noopener">https://Electronjs.org/docs/api/ipc-renderer</a></li>
<li>获取屏幕大小、鼠标位置等信息 screen 模块  <a href="https://Electronjs.org/docs/api/screen" target="_blank" rel="noopener">https://Electronjs.org/docs/api/screen</a></li>
<li>渲染进程使用BrowserWindow 实例  remote模块  <a href="https://Electronjs.org/docs/api/remote" target="_blank" rel="noopener">https://Electronjs.org/docs/api/remote</a></li>
</ul>
<h1 id="暗-坑"><a href="#暗-坑" class="headerlink" title="暗 坑"></a>暗 坑</h1><p>Electron是个很成熟很完善的框架，所以这些也不叫暗坑，只是小白如果没有很仔细的阅读api就可能容易掉坑里，不要问我为什么知道，我是有故事的人</p>
<h2 id="Q、已经引了BrowserWindow-为什么使用函数会是undefined？"><a href="#Q、已经引了BrowserWindow-为什么使用函数会是undefined？" class="headerlink" title="Q、已经引了BrowserWindow 为什么使用函数会是undefined？"></a>Q、已经引了BrowserWindow 为什么使用函数会是undefined？</h2><p>A、Electron分为主进程和渲染进程，Electron 运行 package.json 的 main 脚本的进程被称为主进程只有一个，而渲染进程就是你的页面一个BrowserWindow 实例，所以api也分为主进程和渲染进程以及两者通用的api，所以用api的时候得注意，在渲染进程中使用 BrowserWindow 实例需要引入 remote 模块</p>
<p>主进程可用的模块:app、autoUpdate、BrowserView、BrowserWindow、contentTracing、dialog、globalShortcut、inAppPurchase、ipcMain、Menu、MenuItem、net、netLog、powerMonitor、powerSaveBlocker、protocol、session、systemPreferences、Tray、webContents<br>渲染进程（网页）可用的模块:、desktopCapturer、ipcRenderer、remote、webFrame<br>两种进程都可用的模块:、clipboard、crashReporter、nativeImage、screen、shell</p>
<h2 id="Q、想在渲染进程使用主进程的api？"><a href="#Q、想在渲染进程使用主进程的api？" class="headerlink" title="Q、想在渲染进程使用主进程的api？"></a>Q、想在渲染进程使用主进程的api？</h2><p>A、有某些功能必须得在主进程才能实现，比如保存文件、选择文件路径什么的，这些操作可以使用 ipcRenderer 模块用于两个进程之间的通信，由渲染进程发出指令后在主进程进行功能操作</p>
<h2 id="Q、单击PDF文件的链接时，Electron会提示下载而非直接预览？"><a href="#Q、单击PDF文件的链接时，Electron会提示下载而非直接预览？" class="headerlink" title="Q、单击PDF文件的链接时，Electron会提示下载而非直接预览？"></a>Q、单击PDF文件的链接时，Electron会提示下载而非直接预览？</h2><p>A、单击PDF文件的链接时，在普通浏览器中它会预览该文件。但在Electron中你需要尝试使用 iframe 加载，如果无效可以再试下 webview </p>
<h2 id="Q、动态的修改静态文件的路径会报链接404？"><a href="#Q、动态的修改静态文件的路径会报链接404？" class="headerlink" title="Q、动态的修改静态文件的路径会报链接404？"></a>Q、动态的修改静态文件的路径会报链接404？</h2><p>A、使用Electron-vue框架，动态的修改静态文件的路径会报链接404但是一开始写死就没问题，所有静态文件都建议放在根目录下 static 文件夹下，然后任何页面访问 static/… 即可</p>
<h2 id="Q、透明窗口无效？"><a href="#Q、透明窗口无效？" class="headerlink" title="Q、透明窗口无效？"></a>Q、透明窗口无效？</h2><p>A、新建窗口时已经设置了frame: false,transparent: true, 为什么页面还是白色，开发模式下看透明窗口需要关掉开发者模式后刷新</p>
<h2 id="Q、新建一个窗口，然后拖动该窗口，宽度和高度会小于指定值？"><a href="#Q、新建一个窗口，然后拖动该窗口，宽度和高度会小于指定值？" class="headerlink" title="Q、新建一个窗口，然后拖动该窗口，宽度和高度会小于指定值？"></a>Q、新建一个窗口，然后拖动该窗口，宽度和高度会小于指定值？</h2><p>A、 guthub上有大佬说setResizable: false下最小化且连续恢复，则窗口的高度每次都会减少一个看起来等于菜单栏的量，取消菜单后正常，设置window.setMenu(null)，但是这个方法对我不适用<br>在 issues上翻了一圈，最后 useContentSize: true设置为true + 更改width和height属性以适应测量大小 = 解决</p>
<h2 id="Q、navigator-mediaDevices-getUserMedia-使用该属性报错？"><a href="#Q、navigator-mediaDevices-getUserMedia-使用该属性报错？" class="headerlink" title="Q、navigator.mediaDevices.getUserMedia 使用该属性报错？"></a>Q、navigator.mediaDevices.getUserMedia 使用该属性报错？</h2><p>A、之前使用这个属性报错还以为Electron不支持，感觉很奇怪他继承的是最新的 chromium 为什么会不支持这个属性，然后某天翻api发现 desktopCapturer 模块，这个属性被Electron封装了，需要引入 desktopCapturer 模块，所以敲黑板一定要认真看api</p>
<h2 id="Q、打包问题？"><a href="#Q、打包问题？" class="headerlink" title="Q、打包问题？"></a>Q、打包问题？</h2><p>A、前端大部分框架都封装了webpack，glup什么的都有打包功能，然后一搜 “ 某某框架 打包 ” ，出来的都是什么打包报错？ 空白？一大堆问题，感觉这个问题好像无解<br>之前我写demo的时候打包各种报错，可能是因为写demo的时候各种实验各种乱搞把框架玩坏了，反正正式写项目的时候一个打包问题都没有碰到过<br>只是一点第一次打包的时候很慢，因为Electron需要翻墙下载文件，这时候如果打包失败，多半就是被墙了</p>
<h2 id="Q、’-’和’-‘符号路径问题"><a href="#Q、’-’和’-‘符号路径问题" class="headerlink" title="Q、’\’和’/‘符号路径问题"></a>Q、’\’和’/‘符号路径问题</h2><p>A、通过Electron获取的路径这样的’d:\project...’，本来挺好的文件保存读取什么的用这个路径都挺正常的，但是使用nodejs的exec库调取cmd执行ffmpeg的命令会报错，需要把路径分隔符’\’换成’/‘ </p>
<h2 id="Q、关于新建窗口时的白屏"><a href="#Q、关于新建窗口时的白屏" class="headerlink" title="Q、关于新建窗口时的白屏"></a>Q、关于新建窗口时的白屏</h2><p>A、新建窗口由于加载页面和初始化窗口会有一段时间的白屏，有个方法就是初始化程序的时候就加载的所有窗口，但是只显示主窗口,其余的窗口隐藏,这样就能有效创建窗口时的白屏</p>
</div><div class="copyright">转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达，可以联系我</div><div id="comment"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><div id="gitment_container" data-gitment="{&quot;enable&quot;:true,&quot;id&quot;:&quot;&quot;,&quot;owner&quot;:&quot;tong-h&quot;,&quot;repo&quot;:&quot;tong-h.github.io&quot;,&quot;client_id&quot;:&quot;5658f62c9837c979f96f&quot;,&quot;client_secret&quot;:&quot;36813d127f4f0918cd30231a403e09d81015e014&quot;}"></div><script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script><script>function commentinit() {
    setTimeout(()=>{
        if (Gitment) {
            let string = JSON.parse(document.getElementById('gitment_container').dataset.gitment)
            var gitment = new Gitment({
                id: window.location.href,
                owner: string.owner,
                repo: string.repo,
                oauth: {
                    client_id: string.client_id,
                    client_secret: string.client_secret,
                },
            })
            gitment.render('gitment_container')
        } else commentinit()
    },200)
}
commentinit()</script></div></div><link rel="stylesheet" href="/css/partial/footer.css"><div class="footer"><p><span>Copyright © 2017 - 2019  </span><a href="http://www.beian.miit.gov.cn/">蜀ICP备19024124号</a></p><p>Powered by <a href="https://hexo.io/zh-cn/" target="_blank">Hexo</a> Theme by <a href="https://github.com/Tong-H/hexo-theme-energy" target="_blank">ENERGY</a></p><p><i class="iconfont iconchakan"><span>本站总访问量</span><span id="busuanzi_container_site_pv">  <span id="busuanzi_value_site_pv"></span> </span></i><i class="iconfont iconabout"><span>本站访客数</span><span id="busuanzi_container_site_uv">  <span id="busuanzi_value_site_uv"></span> </span></i></p></div></div></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>var _hmt = _hmt || [];(function(){var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?a4d08c5088ca0d4b18c14260c9ca89a1";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})()</script></body></html>
<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content="没事儿,tong-h,Tong-H,tong-h blog"><meta name="descriptioon" content="personal blog by tong/没事儿"><meta name="renderer" content="wekit"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/css/public.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/iconfont.css"><title>Archives [ 没事儿 ]</title><link rel="stylesheet" href="/css/partial/posts.css"><link rel="stylesheet" href="/css/partial/posts.css"><link rel="stylesheet" href="/css/partial/sidebar.css"><link rel="stylesheet" href="/css/archive.css"><link rel="stylesheet" href="/css/index.css"></head><body class="scroll"><link rel="stylesheet" href="/css/partial/header.css"><div class="header"><div class="maxwidth"><div class="nav"><a id="artlist" href="/archives"><i class="iconfont iconArchives"></i><span class="headhid">&nbsp;Archives</span></a><a id="artlist" href="/about"><i class="iconfont iconAbout"></i><span class="headhid">&nbsp;About</span></a><a id="artlist" href="/404"><i class="iconfont iconCommonweal"></i><span class="headhid">&nbsp;Commonweal</span></a></div><div class="search">It's more tiring to stop</div></div></div><div class="line"></div><div class="main"> <div class="maxwidth"><link rel="stylesheet" href="/css/partial/sidebar.css"><div id="sidebar"><div class="info"><a href="/"><img src="/images/user.png" alt="头像"></a><div><p>没事儿</p></div></div><div class="social"><a href="/archives" title="Home"><i class="iconfont iconHome"></i></a><a href="/atom.xml" title="RSS 源订阅"><i class="iconfont iconsubscribe-1-copy"></i></a><a href="mailto:tongt0232@gmail.com" title="E-Mail"><i class="iconfont iconweibiaoti554"></i></a><a href="https://github.com/tong-h" title="GitHub"><i class="iconfont iconGitHub"></i></a><a href="https://www.jianshu.com/u/20de04cc53de" title="简书"><img src="/images/jianicon-sidebar.png"></a></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/">WEB</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/rests/">rests</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">1</span></li></ul><div class="tags"><a href="/tags/ECharts/" style="font-size: 14px; color: #ffac00">ECharts</a> <a href="/tags/Electron/" style="font-size: 14px; color: #ffac00">Electron</a> <a href="/tags/JSON/" style="font-size: 14px; color: #ffac00">JSON</a> <a href="/tags/angular/" style="font-size: 22px; color: #da8d00">angular</a> <a href="/tags/canvas/" style="font-size: 22px; color: #da8d00">canvas</a> <a href="/tags/cordova/" style="font-size: 30px; color: #b46e00">cordova</a> <a href="/tags/ffmpeg/" style="font-size: 14px; color: #ffac00">ffmpeg</a> <a href="/tags/git/" style="font-size: 14px; color: #ffac00">git</a> <a href="/tags/hexo/" style="font-size: 14px; color: #ffac00">hexo</a> <a href="/tags/http/" style="font-size: 14px; color: #ffac00">http</a> <a href="/tags/markdown/" style="font-size: 14px; color: #ffac00">markdown</a> <a href="/tags/mpvue/" style="font-size: 14px; color: #ffac00">mpvue</a> <a href="/tags/mysql/" style="font-size: 14px; color: #ffac00">mysql</a> <a href="/tags/nginx/" style="font-size: 14px; color: #ffac00">nginx</a> <a href="/tags/nodejs/" style="font-size: 14px; color: #ffac00">nodejs</a> <a href="/tags/npm/" style="font-size: 14px; color: #ffac00">npm</a> <a href="/tags/python/" style="font-size: 14px; color: #ffac00">python</a> <a href="/tags/rests/" style="font-size: 14px; color: #ffac00">rests</a> <a href="/tags/search/" style="font-size: 14px; color: #ffac00">search</a> <a href="/tags/vue/" style="font-size: 14px; color: #ffac00">vue</a> <a href="/tags/yarn/" style="font-size: 14px; color: #ffac00">yarn</a> <a href="/tags/原型链/" style="font-size: 14px; color: #ffac00">原型链</a> <a href="/tags/服务器/" style="font-size: 14px; color: #ffac00">服务器</a> <a href="/tags/死磕英语/" style="font-size: 14px; color: #ffac00">死磕英语</a> <a href="/tags/缓存/" style="font-size: 14px; color: #ffac00">缓存</a> <a href="/tags/网络爬虫/" style="font-size: 22px; color: #da8d00">网络爬虫</a> <a href="/tags/跨域/" style="font-size: 14px; color: #ffac00">跨域</a></div></div><div class="archive rightside"><div id="list_archives" style="opacity: 0;display:  none"><div class="switch" id="arshow"><i class="iconfont iconArchives"></i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li></ul></div><div id="normalposts"><div class="switch" id="poshow"><i class="iconfont iconshijian1"></i></div><article><a class="title" href="/2018/05/23/git/">git常用命令（备忘）</a><div class="content ellipse"><p></p><h1 id="克隆库到相对路径"><a href="#克隆库到相对路径" class="headerlink" title="克隆库到相对路径"></a>克隆库到相对路径</h1><p>git clone <a href="https://github.com/stiekel/hexo-theme-random.git" target="_blank" rel="noopener">https://github.com/stiekel/hexo-theme-random.git</a> themes/random</p>
<p><a href="https://help.github.com/articles/removing-sensitive-data-from-a-repository/" target="_blank" rel="noopener">https://help.github.com/articles/removing-sensitive-data-from-a-repository/</a><br>工作区：电脑里的目录，不包括隐藏的git目录<br>暂存区：add提交到暂存区<br>版本库：commit提交到版本库的分支上</p>
<h1 id="指定用户名和邮箱"><a href="#指定用户名和邮箱" class="headerlink" title="指定用户名和邮箱"></a>指定用户名和邮箱</h1><p>git config  –global  user.name “”<br>git config  –global  user.email “”  </p>
<h1 id="创建版本库"><a href="#创建版本库" class="headerlink" title="创建版本库"></a>创建版本库</h1><p>Cd 版本库的位置/进入文件<br>Mkdir 版本库名<br>pwd（pwd将显示版本库目录和位置）<br>git init（将这个目录变成git可以管理的版本库）</p>
<h1 id="添加文件"><a href="#添加文件" class="headerlink" title="添加文件"></a>添加文件</h1><p>将文件放在版本库目录下<br>git add files （告诉git添加了文件  可以add多个文件）<br>git add –A(如果提交一整个文件夹，add后面加上这条命令)<br>git commit –m “文件说明”（可以一次性提交多个文件）</p>
<h1 id="修改文件"><a href="#修改文件" class="headerlink" title="修改文件"></a>修改文件</h1><p>git status (查看工作区状态)<br>git diff（查看文件具体修改内容）<br>修改文件之后要用add和commit -m重新提交</p>
<h1 id="回退和前进"><a href="#回退和前进" class="headerlink" title="回退和前进"></a>回退和前进</h1><p>git log(查看提交日志历史记录  时间是提交到git的时间  不会显示是哪个文件)<br>git log -pretty=oneline（查看精简的历史记录）<br>git reset –hard HEAD^^(在git中HEAD代表现在的版本，HEAD^代表上一个版本，HEAD^^代表上上个版本，在往上可以用HEAD~100)<br>git reset –hard 版本号（用于当你已经回到之前的版本，想要回到最新的版本）<br>cat files  （查看文件内容）<br>git reflog  （用于你想要回到之前之后某一个版本但不知道那个版本号）</p>
<h1 id="撤销修改"><a href="#撤销修改" class="headerlink" title="撤销修改"></a>撤销修改</h1><p>git checkout – files （两种情况 1、files还没有提交到暂存区但是已经做了修改，这个命令丢弃工作区的更改。2、files提交到暂存区后又做了修改，这个命令可以回到刚提交暂存区的状态）</p>
<p>注意：命令git checkout — readme.txt 中的 — 很重要，如果没有 — 的话，那么命令变成创建分支了。<br>git reset HEAD files（files已经提交到暂存区 这个命令撤销暂存区的文件，让文件回到工作区）</p>
<h1 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h1><p>rm files (删除workspace的文件或者直接在电脑目录里删掉)<br>git add –A<br>git commit –m”修改说明”删除之后不需要复原文件执行这两个命令<br>git checkout – files(用repository里的files替换工作区的files，前提是files已经提交到repository)<br>git rm files(delete the repository files)<br>github删除文件操作    </p>
<h1 id="远程库提交"><a href="#远程库提交" class="headerlink" title="远程库提交"></a>远程库提交</h1><p>ssh-keygen –t rsa –C “email address”(查看sshkey)<br>git remote add origin 远程库地址（绑定远程仓库）<br>git remote rm origin  （用于上一个命令远程仓库填错了，之后重新绑定远程仓库）<br>git push –u origin master（把本地库的内容推送到远程仓库）<br>git push origin master（本地做了提交  用这个命令把最新修改推送到远程库）<br>git oush –u origin +master  (强行更新)<br>git push origin 分支名字  （提交分支修改的内容）</p>
<h1 id="远程库克隆到本地"><a href="#远程库克隆到本地" class="headerlink" title="远程库克隆到本地"></a>远程库克隆到本地</h1><p>git clone远程库地址<br>创建分支与合并分支<br>查看分支：git branch（查看当前分支，会列出所有分支，当前分支前面会添加一个星号）<br>创建分支：git branch name<br>切换分支：git checkout name<br>创建+切换分支：git checkout –b name<br>合并某分支到当前分支：git merge name(在当前分支选择需要合并的分支)</p>
<p>删除分支：git branch –d name<br>分支冲突<br>你在两个分支上修改了内容最后要合并到主分支，照常合并之后查看工作区，在查看文件内容，文件已经更改</p>
<p> git merge –no-ff  -m “注释” name<br>通常合并分支时，git一般使用”Fast forward”模式，在这种模式下，删除分支后，会丢掉分支信息，现在我们来使用带参数 –no-ff来禁用”Fast forward”模式。</p>
<p>查看远程库的信息 git remote<br>查看远程库的详细信息  git remote –v</p>
<p>欢迎留言交流  (´▽`ʃ♡ƪ)</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2018-05-23 11:10</i></div></article><article><a class="title" href="/2018/05/16/Cordova add android 报错/">Cordova add android 报错4种解决方法</a><div class="content ellipse"><p></p><h2 id="方法一：可能网络有问题，换一个源（对我没有用）"><a href="#方法一：可能网络有问题，换一个源（对我没有用）" class="headerlink" title="方法一：可能网络有问题，换一个源（对我没有用）"></a>方法一：可能网络有问题，换一个源（对我没有用）</h2><p>npm i nrm -g 安装nrm</p>
<p>nrm ls 查看当前nrm内置的npm源</p>
<p>nrm use cnpm 切换源</p>
<h2 id="方法二：可能版本有问题（对我没有用）"><a href="#方法二：可能版本有问题（对我没有用）" class="headerlink" title="方法二：可能版本有问题（对我没有用）"></a>方法二：可能版本有问题（对我没有用）</h2><p>npm view cordova-android   查看可选版本</p>
<p>cordova platform add <a href="mailto:android@7.0.0" target="_blank" rel="noopener">android@7.0.0</a>  切换版本</p>
<h2 id="方法三：卸载cordva重新安装（对我没有用）"><a href="#方法三：卸载cordva重新安装（对我没有用）" class="headerlink" title="方法三：卸载cordva重新安装（对我没有用）"></a>方法三：卸载cordva重新安装（对我没有用）</h2><p>运行命令：npm uninstall cordova -g<br>删除文件夹：C：\ Users \ your-name \ .cordova<br>重新安装cordova：npm install -g cordova<br>现在转到项目文件夹，然后再试一次：cordova platform add android<br>方法四：修改环境变量（解决）<br>在环境变量path内加入C:\Windows\System32</p>
<h1 id="如果以上方法对你没有用，可以用cordova-d-platform-add-android调试看下提示信息"><a href="#如果以上方法对你没有用，可以用cordova-d-platform-add-android调试看下提示信息" class="headerlink" title="如果以上方法对你没有用，可以用cordova -d platform add android调试看下提示信息"></a>如果以上方法对你没有用，可以用cordova -d platform add android调试看下提示信息</h1><p>相关博文：Android SDK 环境配置/Cordova环境搭建打包apk各种踩坑报错系列</p>
<p>欢迎留言交流  (´▽`ʃ♡ƪ)</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2018-05-16 16:29</i></div></article><article><a class="title" href="/2018/05/13/阿里云服务器/">阿里云服务器</a><div class="content ellipse"><p></p><p>新手入门弄了一个阿里云服务器自己学习使用</p>
<p>在官网上点击远程链接出现了终端管理的画面，安装官网的步骤一步一步的在本机尝试远程连接（系统win7），输入ip地址，用户名，点击确定，弹框输密码</p>
<p>然后就告诉我：你的凭据不工作，之前用于链接到***的凭据无法工作，请输入新凭据</p>
<p>之后各种百度，尝试各种方法</p>
<p>可能导致此故障的原因</p>
<p>1、客户端本地网络异常 [出现概率：3%]</p>
<p>这个就…</p>
<p>2、重置实例密码，未重启实例 [出现概率：7%] 找到原因，自己手贱改了密码不知道要重启<br>故障现象：有实例密码修改记录，但无重启实例记录。</p>
<p>可能原因：您修改了实例密码，但是未重启 ECS 实例。</p>
<p>解决方法：</p>
<p>登录云服务器管理控制台。<br>单击左侧导航栏中的 实例。<br>单击页面顶部的地域。<br>选择需要的实例。单击 重启。<br>在弹出的提示框中，选择 重启，单击 确定。</p>
<p>3、防火墙配置异常（Windows 2008&amp;2012）[出现概率：10%]</p>
<p>前提条件：您只有在已授权可关闭防火墙的情况下，才能做该项排查。<br>故障现象：远程无法连接，关闭 防火墙 后连接恢复。<br>解决方法：调整防火墙配置策略，具体操作详见官网：ECS Windows 远程连接之防火墙设置。<br>完成操作后，请再进行远程连接。</p>
<p>4、安全组公网规则 [出现概率：8%]</p>
<p>故障现象：ECS 服务器无法ping通，排查防火墙、网卡 IP 配置无误，回滚系统后仍然无法ping通。<br>可能原因：ECS 实例安全组默认的公网规则被删除。<br>解决方法：重新配置 ECS 实例的安全组公网规则，具体操作详见 ECS实例安全组默认的公网规则被删除导致无法ping通。</p>
<p>5、远程访问端口配置异常 [出现概率：10%]</p>
<p>故障现象：远程无法连接，远程访问端口非默认端口。<br>解决方法：<br>运行注册表，然后查看此文档<a href="https://yq.aliyun.com/articles/33712" target="_blank" rel="noopener">https://yq.aliyun.com/articles/33712</a></p>
<p>6、CPU 负载过高 [出现概率：9%]</p>
<p>故障现象：CPU 负载过高导致系统无法进行远程连接。</p>
<p>附上官网关于连接失败的的文档：</p>
<p><a href="https://help.aliyun.com/knowledge_detail/40849.html?spm=a2c4g.11186623.4.1.zfSNDN" target="_blank" rel="noopener">https://help.aliyun.com/knowledge_detail/40849.html?spm=a2c4g.11186623.4.1.zfSNDN</a></p>
<p><a href="https://help.aliyun.com/knowledge_detail/50982.html" target="_blank" rel="noopener">https://help.aliyun.com/knowledge_detail/50982.html</a></p>
<p>其他楼主遇到的这格问题的一些解决方法，百度搜来大多都是差不多，这个楼主的方法蛮全的</p>
<p><a href="https://blog.csdn.net/sun15732621550/article/details/50444398" target="_blank" rel="noopener">https://blog.csdn.net/sun15732621550/article/details/50444398</a></p>
<p>欢迎留言交流  (´▽`ʃ♡ƪ)</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2018-05-13 13:13</i></div></article><article><a class="title" href="/2018/01/31/angular_constant&amp;filter/">angular之constant和filter</a><div class="content ellipse"><p></p><h1 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h1><p>angular是什么：AngularJS最初由Misko Hevery和Adam Abrons于2009年开发，后来成为了Google公司的项目。AngularJS弥补了HTML在构建应用方面的不足，其通过使用标识符（directives）结构，来扩展Web应用中的HTML词汇，使开发者可以使用HTML来声明动态内容，从而使得Web开发和测试工作变得更加容易。</p>
<p>constant，可以算作angular的全局数据，想要使用的话，只需要在控制器注入即可。</p>
<p>$filter，angular的过滤器，如果想要在控制器里面使用，也是注入，然后调用，而html中的数据过滤，直接键入过滤器名称和对应值即可。</p>
<h1 id="知识剖析"><a href="#知识剖析" class="headerlink" title="知识剖析"></a>知识剖析</h1><p>每当搜索constant时候，总会连带出现value的说明。</p>
<p>两者都可以作为全局变量使用，但是有两点不同：</p>
<p>1.value不可以在config里注入，但是constant可以。</p>
<p>2.value可以修改，但是constant不可以修改，一般直接用constant配置一些需要经常使用的数据。</p>
<p>下面是简单的应用例子：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'myApp'</span>, [])</span><br><span class="line">.constant(<span class="string">'apiKey'</span>, <span class="string">'123123123'</span>)</span><br><span class="line">.value(<span class="string">'FBid'</span>,<span class="string">'231231231'</span>)</span><br><span class="line">.controller(<span class="string">'myController'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope,apiKey,FBid</span>)</span>&#123;</span><br><span class="line">$scope.a = apiKey;</span><br><span class="line">$scope.b = FBid;</span><br><span class="line">&#125;)</span><br><span class="line">.config(<span class="function"><span class="keyword">function</span>(<span class="params">apiKey</span>) </span>&#123;</span><br><span class="line"><span class="comment">//在这里apiKey将被赋值为123123123</span></span><br><span class="line"><span class="comment">//就像上面设置的那样</span></span><br><span class="line">&#125;)</span><br><span class="line">.config(<span class="function"><span class="keyword">function</span>(<span class="params">FBid</span>) </span>&#123;</span><br><span class="line"><span class="comment">//这将抛出一个错误，未知的provider: FBid</span></span><br><span class="line"><span class="comment">//因为在config函数内部无法访问这个值</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>filter是用来格式化数据用的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">基本原型：&#123;&#123;expression | filter&#125;&#125;</span><br><span class="line"></span><br><span class="line">多个filter连用版：&#123;&#123;expression | filter1 | filter2&#125;&#125;</span><br><span class="line"></span><br><span class="line">传入参数版：&#123;&#123;expression | filter:1:2&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><p>如何使用angular中constant和$filter？</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><p>4.1 AngularJS内建了一些常用的filter：</p>
<p>1、格式化货币：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; 12 | currency&#125;&#125;  //将12格式化为货币，默认单位符号为&apos;$&apos;,小数默认2位</span><br><span class="line"></span><br><span class="line">&#123;&#123; 12.45 | currency:&apos;￥&apos;&#125;&#125; //将12.45格式化为货币，使用自定义单位符号为&apos;￥&apos;,小数默认2位</span><br><span class="line"></span><br><span class="line">&#123;&#123; 12.45 | currency:&apos;CHY￥&apos;:1&#125;&#125; //将12.45格式化为货币，使用自定义单位符号为&apos;CHY￥&apos;,小数指定1位,会执行四舍五入操作</span><br><span class="line"></span><br><span class="line">&#123;&#123; 12.55 | currency:undefined:0&#125;&#125; //将12.55格式化为货币， 不改变单位符号， 小数部分将四舍五入</span><br></pre></td></tr></table></figure></p>
<p>2、格式化日期：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; 1304375948024 | date:&apos;medium&apos;&#125;&#125;//May 03, 2011 06:39:08 PM</span><br><span class="line"></span><br><span class="line">&#123;&#123; 1304375948024 | date &#125;&#125;//结果：May 3, 2011</span><br><span class="line"></span><br><span class="line">&#123;&#123; 1304375948024 | date:&quot;MM/dd/yyyy @ h:mma&quot; &#125;&#125;//结果：05/03/2011 @ 6:39AM</span><br><span class="line"></span><br><span class="line">&#123;&#123; 1304375948024 | date:&quot;yyyy-MM-dd hh:mm:ss&quot; &#125;&#125;//结果：2011-05-03 06:39:08</span><br></pre></td></tr></table></figure></p>
<p>3、过滤数组：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$scope.arr = [&#123;&quot;age&quot;: 20,&quot;id&quot;: 10,&quot;name&quot;: &quot;iphone&quot;&#125;, &#123;&quot;age&quot;: 12,&quot;id&quot;: 11,&quot;name&quot;: &quot;sunm xing&quot;&#125;, &#123;&quot;age&quot;: 44,&quot;id&quot;: 12,&quot;name&quot;: &quot;test abc&quot;&#125; ]</span><br><span class="line"></span><br><span class="line">&#123;&#123;arr | filter:&apos;s&apos;&#125;&#125;  //查找含有有s的行//上例结果：[&#123;&quot;age&quot;:12,&quot;id&quot;:11,&quot;name&quot;:&quot;sunm xing&quot;&#125;,&#123;&quot;age&quot;:44,&quot;id&quot;:12,&quot;name&quot;:&quot;test abc&quot;&#125;]</span><br><span class="line"></span><br><span class="line">&#123;&#123;arr | filter:&#123;&apos;name&apos;:&apos;ip&apos;&#125; &#125;&#125;//查找name like ip的行//上例结果:[&#123;&quot;age&quot;:20,&quot;id&quot;:10,&quot;name&quot;:&quot;iphone&quot;&#125;]</span><br></pre></td></tr></table></figure></p>
<p>4、将对象格式化成标准的JSON格式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; &#123;name:&apos;Jack&apos;, age: 21&#125; | json&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>5、字符串，对象截取：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; &quot;i love tank&quot; | limitTo:6 &#125;&#125;//结果：i love</span><br><span class="line"></span><br><span class="line">&#123;&#123; &quot;i love tank&quot; | limitTo:-4 &#125;&#125;//结果：tank</span><br><span class="line"></span><br><span class="line">&#123;&#123; [&#123;&quot;age&quot;: 20,&quot;id&quot;: 10,&quot;name&quot;: &quot;iphone&quot;&#125;, &#123;&quot;age&quot;: 12,&quot;id&quot;: 11,&quot;name&quot;: &quot;sunm xing&quot;&#125;, &#123;&quot;age&quot;: 44,&quot;id&quot;: 12,&quot;name&quot;: &quot;test abc&quot;&#125; ] | limitTo:1 &#125;&#125;//结果：[&#123;&quot;age&quot;:20,&quot;id&quot;:10,&quot;name&quot;:&quot;iphone&quot;&#125;]</span><br></pre></td></tr></table></figure></p>
<p>6、大小写转换：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">China has joined the &#123;&#123; &quot;wto&quot; | uppercase &#125;&#125;.</span><br><span class="line">We all need &#123;&#123; &quot;MONEY&quot; | lowercase &#125;&#125;.</span><br></pre></td></tr></table></figure></p>
<p>7、数值类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; 1.234567 | number:1 &#125;&#125;  //结果：1.2</span><br><span class="line">&#123;&#123; 1234567 | number &#125;&#125;    //结果：1,234,567</span><br></pre></td></tr></table></figure></p>
<p>8、对象排序：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$scope.arr = [&#123;&quot;age&quot;: 20,&quot;id&quot;: 10,&quot;name&quot;: &quot;iphone&quot;&#125;, &#123;&quot;age&quot;: 12,&quot;id&quot;: 11,&quot;name&quot;: &quot;sunm xing&quot;&#125;, &#123;&quot;age&quot;: 44,&quot;id&quot;: 12,&quot;name&quot;: &quot;test abc&quot;&#125; ]</span><br><span class="line">&#123;&#123;arr | orderBy:&apos;id&apos;:true &#125;&#125;//根id降序排</span><br><span class="line">&#123;&#123;arr | orderBy:&apos;id&apos; &#125;&#125;//根据id升序排</span><br></pre></td></tr></table></figure></p>
<h2 id="自定义filter方法"><a href="#自定义filter方法" class="headerlink" title="自定义filter方法"></a>自定义filter方法</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">我们来自定义选择省份和职位</span><br><span class="line"></span><br><span class="line">HTML代码：</span><br><span class="line">&#123;&#123;<span class="number">1</span> | provinceFilter&#125;&#125;</span><br><span class="line">&#123;&#123;<span class="number">6</span> | fMes:<span class="string">'positionList'</span>:<span class="string">'type'</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">app.js:</span><br><span class="line">angular.module(<span class="string">'myApp'</span>,[])</span><br><span class="line"><span class="comment">//数组</span></span><br><span class="line">.controller(<span class="string">'personCtrl'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</span><br><span class="line">  $scope.arr=[</span><br><span class="line">    &#123;<span class="string">"age"</span>:<span class="number">20</span>,<span class="string">"id"</span>:<span class="number">10</span>,<span class="string">"name"</span>:<span class="string">"iphone"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"age"</span>:<span class="number">12</span>,<span class="string">"id"</span>:<span class="number">11</span>,<span class="string">"name"</span>:<span class="string">"sunm xing"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"age"</span>:<span class="number">44</span>,<span class="string">"id"</span>:<span class="number">12</span>,<span class="string">"name"</span>:<span class="string">"test abc"</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">//自定义选择省份</span></span><br><span class="line">.filter(<span class="string">'provinceFilter'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">PROVINCE</span>)</span>&#123;<span class="comment">//省</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(id!=<span class="literal">undefined</span>&amp;&amp;id!=<span class="string">''</span>)&#123;</span><br><span class="line">      <span class="keyword">var</span>  name;</span><br><span class="line">      angular.forEach(PROVINCE,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(data.ProID==id)&#123;</span><br><span class="line">              name=data.ProName;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  <span class="keyword">return</span>  name;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义选择职位</span></span><br><span class="line"></span><br><span class="line">.filter(<span class="string">'fMes'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">con</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">input,field,str</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(input&gt;=<span class="number">0</span>) &#123;<span class="comment">//input != undefined &amp;&amp;</span></span><br><span class="line">    <span class="keyword">var</span> name;</span><br><span class="line">    <span class="keyword">var</span> aMes=con[field];</span><br><span class="line">    angular.forEach(aMes,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(data[str]==input)&#123;</span><br><span class="line">          name=data.name;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;<span class="built_in">console</span>.log(<span class="string">'false'</span>);&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">constant.js</span><br><span class="line">angular.module(<span class="string">"myApp"</span>) .value(<span class="string">'val'</span>,&#123;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//公司编辑常量组</span></span><br><span class="line">.constant(<span class="string">'con'</span>,&#123;</span><br><span class="line"><span class="comment">//职业分类</span></span><br><span class="line">positionList:[</span><br><span class="line">  &#123;<span class="attr">type</span>:<span class="number">0</span>,<span class="attr">name</span>:<span class="string">'ui设计师'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">type</span>:<span class="number">1</span>,<span class="attr">name</span>:<span class="string">'运维工程师'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">type</span>:<span class="number">2</span>,<span class="attr">name</span>:<span class="string">'产品'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">type</span>:<span class="number">3</span>,<span class="attr">name</span>:<span class="string">'Java工程师'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">type</span>:<span class="number">4</span>,<span class="attr">name</span>:<span class="string">'IOS工程师'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">type</span>:<span class="number">5</span>,<span class="attr">name</span>:<span class="string">'Android工程师'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">type</span>:<span class="number">6</span>,<span class="attr">name</span>:<span class="string">'Web前端工程师'</span>&#125;</span><br><span class="line">]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>显示的结果是：Web前端工程师，改变type值，显示相应的职位。</p>
<h1 id="拓展思考"><a href="#拓展思考" class="headerlink" title="拓展思考"></a>拓展思考</h1><p>AngularJS的内置过滤器有哪些？</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>参考一：angularJS constant和value<br>参考二：AngularJS的Filter用法详解</p>
<h1 id="更多提问"><a href="#更多提问" class="headerlink" title="更多提问"></a>更多提问</h1><p>1、constant函数取值，和直接用常量名有什么区别</p>
<p>答：大多数情况直接用常量名，但是在angular中，使用constant的字段约定与后台进行数据交互的时候很方便，结构更加清晰。constant()函数和直接使用常量名输出的效果是一样的，但函数可以动态的输出不同的常量，在使用上要灵活、方便。</p>
<p>2、filter怎么去掉时间的秒<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">答：&#123;&#123;date | date : &apos;yyyy-MM-dd hh:mm:ss EEEE&apos;&#125;&#125;</span><br><span class="line">参数用来指定所要的格式，y M d h m s E 分别表示 年 月 日 时 分 秒 星期，你可以自由组合它们</span><br></pre></td></tr></table></figure></p>
<p>3、什么情况下使用filter</p>
<p>答：常用的就是一个date的格式转换，表格中进行排序、还有大量的一些约定字段，使用自定义的filter。</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2018-01-31 20:58</i></div></article><article><a class="title" href="/2018/01/18/NPM&amp;CNPM/">如何使用NPM？CNPM又是什么？</a><div class="content ellipse"><p></p><h1 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h1><p>什么是npm</p>
<p>npm（node package manager）是nodejs的包管理器，用于node插件管理（包括安装、卸载、管理依赖等）, NPM是随同NodeJS一起安装的包管理工具，能解决NodeJS代码部署上的很多问题，它是 Node 获得成功的重要原因之一。常见的使用场景有以下几种：</p>
<p>允许用户从NPM服务器下载别人编写的第三方包到本地使用。</p>
<p>允许用户从NPM服务器下载并安装别人编写的命令行程序到本地使用。</p>
<p>允许用户将自己编写的包或命令行程序上传到NPM服务器供别人使用。</p>
<p>由于新版的nodejs已经集成了npm，所以之前npm也一并安装好了。同样可以通过输入 “npm -v” 来测试是否成功安装</p>
<p>为啥我们需要一个包管理工具呢？因为我们在Node.js上开发时，会用到很多别人写的JavaScript代码。如果我们要使用别人写的某个包，每次都根据名称搜索一下官方网站，下载代码，解压，再使用，非常繁琐。于是一个集中管理的工具应运而生：大家都把自己开发的模块打包后放到npm官网上，如果要使用，直接通过npm安装就可以直接用，不用管代码存在哪，应该从哪下载。</p>
<p>更重要的是，如果我们要使用模块A，而模块A又依赖于模块B，模块B又依赖于模块X和模块Y，npm可以根据依赖关系，把所有依赖的包都下载下来并管理起来。否则，靠我们自己手动管理，肯定既麻烦又容易出错。</p>
<p>什么是cnpm?</p>
<p>因为npm安装插件是从国外服务器下载，受网络影响大，可能出现异常，所以我们乐于分享的淘宝团队干了这事。来自官网：“这是一个完整 npmjs.org 镜像，你可以用此代替官方版本(只读)，同步频率目前为 10分钟 一次以保证尽量与官方服务同步。”</p>
<h1 id="知识剖析"><a href="#知识剖析" class="headerlink" title="知识剖析"></a>知识剖析</h1><p>NPM常用指令</p>
<p>1、npm install moduleNames：安装Node模块</p>
<p>安装完毕后会产生一个node_modules目录，其目录下就是安装的各个node模块。</p>
<p>node的安装分为全局模式和本地模式。</p>
<p>一般情况下会以本地模式运行，包会被安装到和你的应用程序代码的本地node_modules目录下。</p>
<p>在全局模式下，Node包会被安装到Node的安装目录下的node_modules下</p>
<p>一些npm的简单命令就不多说了</p>
<p>为什么要保存至PACKAGE.JSON？</p>
<p>因为node插件包非常大，版本庞杂，所以不加入package信息，模块间的依赖变得非常困难，将配置信息写入package.json并将其加入版本管理，其他开发者对应下载即可（命令提示符执行npm install，则会根据package.json下载所有需要的包）。 每个项目的根目录下面，一般都有一个package.json文件，定义了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等元数据）。npm install 命令根据这个配置文件，自动下载所需的模块，也就是配置项目所需的运行和开发环境。</p>
<p>PACKAGE.JSON 属性说明：</p>
<p>name - 包名。（不要把node或者js放在名字中）</p>
<p>version - 包的版本号。</p>
<p>dependencies - 项目运行所依赖的模块</p>
<p>devDependencies - 项目开发所需要的模块</p>
<p>bin - 这需要在你的package.json中提供一个bin字段，它是一个命令名和本地文件名的映射。在安装时，如果是全局安装，npm将会使用符号链接把这些文件链接到prefix/bin，如果是本地安装，会链接到./node_modules/.bin/</p>
<p>使用npm卸载插件：npm uninstall &lt; name &gt; [-g] [–save-dev] PS：不要直接删除本地插件包</p>
<p>使用npm更新插件：npm update &lt; name &gt; [-g] [–save-dev] </p>
<p>更新全部插件：npm update [–save-dev] </p>
<p>查看npm帮助：npm help </p>
<p>查看当前目录已安装插件：npm list </p>
<p>PS：npm安装插件过程：从<a href="http://registry.npmjs.org下载对应的插件包（该网站服务器位于国外，所以经常下载缓慢或出现异常），解决办法就是cnpm" target="_blank" rel="noopener">http://registry.npmjs.org下载对应的插件包（该网站服务器位于国外，所以经常下载缓慢或出现异常），解决办法就是cnpm</a></p>
<p>CNPM介绍：</p>
<p>官方网址：<a href="http://npm.taobao.org" target="_blank" rel="noopener">http://npm.taobao.org</a></p>
<p>安装：命令提示符执行npm install cnpm -g –registry=<a href="https://registry.npm.taobao.org" target="_blank" rel="noopener">https://registry.npm.taobao.org</a></p>
<p>注意：安装完后最好查看其版本号cnpm -v或关闭命令提示符重新打开，安装完直接使用有可能会出现错误 </p>
<p>PS：cnpm跟npm用法完全一致，只是在执行命令时将npm改为cnpm。</p>
<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><p>bower 和 npm有什么区别</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><p>npm 是伴随 Node.js 出现的一个包管理器，最开始只能支持 Node.js 的模块管理，但是后来， npm 官网经过一次改版，打出的口号是，javascript 的包管理器，所以，其已经不在局限于是 Node.js 的模块管理了，已经通用到了所有 js 的包管理工具了，可以说，前后通吃了。</p>
<p>bower 的话，从一开始，就是专门为前端表现设计的包管理器，一切全部为前端考虑的。npm 和 bower 的最大区别，就是 npm 支持嵌套地依赖管理，而 bower只能支持扁平的依赖（嵌套的依赖，由 程序员自己解决）。</p>
<p>嵌套依赖，指的就是，你依赖的软件包，还有它自己的依赖，好像摘葡萄，一摘一大串。在服务器环境的时候，这并没什么关系，因为存储空间够大，一切代码都是本地运行，只要解决完依赖就行了， 但是到了用户产品的浏览器里，就很成问题了，你不能让用户去下载好几M的js代码，那就太糟糕了。在这个情况下，就需要程序员自己手动解决用到的类库的嵌套依赖问题。比如确保各种各样的插件 都依赖同一个版本的jQuery。</p>
<h1 id="扩展思考"><a href="#扩展思考" class="headerlink" title="扩展思考"></a>扩展思考</h1><p>cnpm有哪些问题？</p>
<p>1.cnpm 的仓库只是 npm 仓库的一个拷贝，它不承担 publish 工作，所以你用 cnpm publish 命令会执行失败的</p>
<p>2.不仅是 publish 会执行失败，其它的需要注册用户(npm adduser)、或者修改 package 状态等命令都无法用 cnpm</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><ul>
<li><p>npm 模块安装机制简介</p>
</li>
<li><p>开发者对 npm 公司不满，unpublish 了自己的所有模块</p>
</li>
<li><p>npm的一些常用命令</p>
</li>
<li><p>bower 和 npm 的区别详细介绍</p>
</li>
</ul>
<h1 id="更多提问"><a href="#更多提问" class="headerlink" title="更多提问"></a>更多提问</h1><p>Q:全局安装和本地安装的区别？</p>
<p>A:因为全局模式安装,包可以供所有的程序使用。本地安装则不可以。 npm 默认会把包安装到当前目录下。这反映了 npm 不同的设计哲学。如 果把包安装到全局,可以提高程序的重复利用程度,避免同样的内容的多 份副本,但坏处是难以处理不同的版本依赖。如果把包安装到当前目录, 或者说本地,则不会有不同程序依赖不同版本的包的冲突问题,同时还减 轻了包作者的 API 兼容性压力,但缺陷则是同一个包可能会被安装许多次。</p>
<p>Q:为什么进行了全局安装还要进行本地安装</p>
<p>A:为什么进行了全局安装还要进行本地安装</p>
<p> 1、在js实例代码中，默认下node.js会在NODE_PATH和目前js所在项目下的node_modules文件夹下去寻找模块，因此，如果只是全局安装，不能直接通过require()的方式去引用模块，需要手动解决包路径的配置问题，当然你也可以复制全局安装的node_modules文件夹到项目下，还有办法可以选择将环境变量的NODE_PATH设置为C:\Program Files\nodejs。 2.对于包的更新不好管理，可能你需要为每个包重新命名，如<a href="mailto:gulp@3.8.1" target="_blank" rel="noopener">gulp@3.8.1</a>、<a href="mailto:gulp@3.9.1" target="_blank" rel="noopener">gulp@3.9.1</a>…，为了区别不同项目使用指定的包，保证模块之间的相互依赖，区别每个项目正常运行</p>
<p>Q：如何在package.JSON的dependencies和devDependencies写入信息</p>
<p>A:npm install –save babel-cli和npm install -dev babel-cli使用这两个命令安装后可自动写入文件</p>
<p>npm install –save-dev babel-cli也可以在一起用</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2018-01-18 21:35</i></div></article><article><a class="title" href="/2018/01/04/JSON/">JSON是什么，如何处理转义？</a><div class="content ellipse"><p></p><h1 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h1><p>JSON一种数据交换格式。在JSON出现之前， 大家一直用XML来传递数据。因为XML是一种纯文本格式，所以它适合在网络上交换数据。XML本身不算复杂，但是， 加上DTD、XSD、XPath、XSLT等一大堆复杂的规范以后，即使你努力钻研几个月，也未必搞得清楚XML的规范。</p>
<p>终于，在2002年的一天，道格拉斯·克罗克福特发明了JSON这种超轻量级的数据交换格式。</p>
<p>由于JSON非常简单，很快就风靡Web世界。而在JavaScript中，我们可 以直接使用JSON，因为JavaScript内置了JSON的解析。把任何JavaScript对象变成JSON，就是把这个对象序列化成一个JSON 格式的字符串，这样才能够通过网络传递给其他计算机。如果我们收到一个JSON格式的字符串，只需要把它反序列化成一个JavaS cript对象，就可以在JavaScript中直接使用这个对象了。</p>
<h1 id="知识剖析"><a href="#知识剖析" class="headerlink" title="知识剖析"></a>知识剖析</h1><p>JSON语法</p>
<p>数据在名称/值对中</p>
<p>数据由逗号分隔</p>
<p>大括号保存对象</p>
<p>中括号保存数组</p>
<p>JSON值</p>
<p>数字(整数/浮点数)</p>
<p>字符串(双引号)</p>
<p>布尔值(true/false)</p>
<p>数组(中括号中)</p>
<p>对象(大括号中)</p>
<p>null</p>
<p>实例</p>
<p>JSON 数据的书写格式是：名称/值对。</p>
<p>名称/值对组合中的名称写在前面（在双引号中），值对写在后面，中间用冒号隔开，</p>
<p>其中 值 可以是：数字（整数或浮点数）、字符串（在双引号中）、逻辑值（true或false）、数组（在方括号中）、对象（在花括号中）、null</p>
<p>使用方式：</p>
<p>varjson= {“name”:”myname”,”password”:123456}</p>
<p>或者是嵌套使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">  myObj = &#123;</span><br><span class="line"></span><br><span class="line">      &quot;name&quot;:&quot;runoob&quot;,</span><br><span class="line"></span><br><span class="line">      &quot;alexa&quot;:10000,</span><br><span class="line"></span><br><span class="line">      &quot;sites&quot;: &#123;</span><br><span class="line"></span><br><span class="line">          &quot;site1&quot;:&quot;www.runoob.com&quot;,</span><br><span class="line"></span><br><span class="line">          &quot;site2&quot;:&quot;m.runoob.com&quot;,</span><br><span class="line"></span><br><span class="line">          &quot;site3&quot;:&quot;c.runoob.com&quot;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  console.log(myObj)</span><br><span class="line"></span><br><span class="line">//输出结果：</span><br><span class="line"></span><br><span class="line">Object &#123;name: &quot;runoob&quot;, alexa: 10000, sites: Object&#125;</span><br></pre></td></tr></table></figure></p>
<p>转义概述</p>
<p>为什么需要转义？在js中我们使用的js对象进行处理，但是在与后端数据交换的时候，我们发送规定的json格式的字符串，所以在给后端发送或接受数据的时候，需要</p>
<p>{name:”myname”,password:123456} &lt;–&gt; “{“name”:”myname”,”password”:123456}”</p>
<p>其中json字符串转js对象，调用parse方法：</p>
<p>js对象 = JSON.parse(json字符串);</p>
<p>js对象转json字符串，调用stringify方法：</p>
<p>json字符串 = JSON.stringify(js对象);</p>
<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><p>除了以上两种方法还有什么可以转化</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">用eval_r(&apos;(&apos;+json字符串+&apos;)&apos;)这个方法可以实现json计算</span><br><span class="line"></span><br><span class="line">var value = 1;</span><br><span class="line"></span><br><span class="line">var js = &apos;&#123;&quot;data1&quot;:&quot;hello&quot;,&quot;data2&quot;:value++&#125;&apos;;</span><br><span class="line"></span><br><span class="line">console.log(js);</span><br><span class="line"></span><br><span class="line">var data1 = eval(&quot;(&quot;+js+&quot;)&quot;);</span><br><span class="line"></span><br><span class="line">console.log(data1);</span><br><span class="line"></span><br><span class="line">var data2=JSON.stringify(js);</span><br><span class="line"></span><br><span class="line">console.log(data2);</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<p>eval_r获取的json对象的值中，如果有执行代码，也将照样执行！所以若不能保证数据的安全性，不要使用eval_r方法进行转义。</p>
<h1 id="扩展思考"><a href="#扩展思考" class="headerlink" title="扩展思考"></a>扩展思考</h1><p>我们常看到{name:”myname”,password:123456}和{“name”:”myname”,”password”:123456}这样两种格式，即js对象和json，然而js对象和json有什么不一样的地方？</p>
<p>一个栗子大家可以自己在浏览器上运行一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">var jso1=&#123;</span><br><span class="line"></span><br><span class="line">a:&quot;name&quot;,&quot;b&quot;:&quot;age&quot;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var jso2=&#123;</span><br><span class="line"></span><br><span class="line">&quot;a&quot;:&quot;name&quot;,&quot;b&quot;:&quot;age&quot;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(jso1.a === jso2.a);</span><br><span class="line"></span><br><span class="line">console.log(jso1.b === jso2.b);</span><br><span class="line"></span><br><span class="line">console.log(jso1 === jso2);</span><br><span class="line"></span><br><span class="line">console.log(jso1);</span><br><span class="line"></span><br><span class="line">console.log(jso2);</span><br><span class="line"></span><br><span class="line">var jso3=JSON.stringify(jso1);</span><br><span class="line"></span><br><span class="line">console.log(jso3);</span><br><span class="line"></span><br><span class="line">var jso4=JSON.parse(&#123;</span><br><span class="line"></span><br><span class="line">&apos;a&apos;:&quot;name&quot;,&quot;b&quot;:&quot;age&quot;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">var jso4=JSON.parse(&apos;&#123;\&quot;a\&quot;:\&quot;name\&quot;, \&quot;b\&quot;:\&quot;age\&quot;&#125;&apos;);</span><br><span class="line"></span><br><span class="line">console.log(jso4);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">`</span><br></pre></td></tr></table></figure></p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>参考一：百度百科</p>
<p>参考二：Json对象和Json字符串的区别</p>
<p>参考三：json属性名必须加引号的讨论</p>
<h1 id="更多讨论"><a href="#更多讨论" class="headerlink" title="更多讨论"></a>更多讨论</h1><p>Q：JSON对象有什么遍历方法，如何做</p>
<p>A：用jq方法$.each遍历json对象</p>
<p>Q：angularjs如何转换字符串和对象</p>
<p>A：angular.fromJson( );</p>
<pre><code>angular.toJson();
</code></pre><p>Q：json和jisonp有什么区别</p>
<p>A：json返回的是一串数据；而jsonp返回的是脚本代码（包含一个函数调用）</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2018-01-04 05:31</i></div></article><article><a class="title" href="/2017/12/26/JS_原型链/">JS中的原型链是什么？</a><div class="content ellipse"><p></p><h1 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h1><p>JS中万物皆对象，但是分为两大类，函数对象，普通对象</p>
<p>所有的函数对象都有一个prototype属性，这个属性引用了一个对象，即原型对象，也称原型。 然而普通对象是没有prototype属性，只有<em>proto</em>属性</p>
<h1 id="知识剖析"><a href="#知识剖析" class="headerlink" title="知识剖析"></a>知识剖析</h1><p>vara = {};console.log(a.prototype);//undefined</p>
<p>console.log(a.<strong>proto</strong>);//Object {}</p>
<p>var b =function(){}</p>
<p>console.log(b.prototype);//b {}</p>
<p>console.log(b.<strong>proto</strong>);//function() {}</p>
<p>/<em>1、字面量方式</em>/</p>
<p> var a = {};</p>
<p>console.log(a.<strong>proto</strong>);  //Object {}</p>
<p>console.log(a.<strong>proto</strong> === a.constructor.prototype); //true</p>
<p> /<em>2、构造器方式</em>/</p>
<p>var A = function(){};</p>
<p>var a = new A();</p>
<p> console.log(a.<strong>proto</strong>); //A {}</p>
<p>console.log(a.<strong>proto</strong> === a.constructor.prototype); //true</p>
<p> /<em>3、Object.create()方式</em>/</p>
<p>var a1 = {a:1}</p>
<p> var a2 = Object.create(a1);</p>
<p>console.log(a2.<strong>proto</strong>); //Object {a: 1}</p>
<p>console.log(a.<strong>proto</strong> === a.constructor.prototype); //false</p>
<p>constructor 属性返回对创建此对象的数组函数的引用</p>
<p><em>proto</em>的指向取决于对象创建时的实现方式</p>
<p>大多数情况下，<em>proto</em>可以理解为构造器的原型，即：<em>proto</em> === constructor.prototype</p>
<p>但是通过Object.create()创建的对象不使用此等式</p>
<p>functionFoo1(){this.name1 =’1’;}</p>
<p>functionFoo2(){this.name2 =’2’;}</p>
<p>Foo2.prototype =newFoo1();</p>
<p>functionFoo3(){this.name =’3’;}</p>
<p>Foo3.prototype =newFoo2();</p>
<p>varfoo3 =newFoo3();</p>
<p>console.log(foo3);</p>
<p>当我们「读取」 foo3的某个属性得时候，jS 引擎会做下面的事情：</p>
<ol>
<li><p>看看 foo3 对象本身有没有这个属性。没有就走到下一步。</p>
</li>
<li><p>看看 foo3.<strong>proto</strong> 对象有没有这个属性，发现 foo3.<strong>proto</strong> 有这个属性，于是找到了</p>
</li>
<li><p>如果 foo3.<strong>proto</strong> 没有，那么浏览器会继续查看 foo3.<strong>proto</strong>.<strong>proto</strong></p>
</li>
<li><p>如果 foo3.<strong>proto</strong>.<strong>proto</strong> 也没有，那么浏览器会继续查看 foo3.<strong>proto</strong>.<strong>proto</strong>.proto__</p>
</li>
<li><p>直到找到 或者 <strong>proto</strong> 为 null。</p>
</li>
</ol>
<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><p>若想访问一个对象的原型，应该使用什么方法？</p>
<h1 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h1><p>1、使用<em>proto</em>属性</p>
<p>每个JS对象一定对应一个原型对象，并从原型对象继承属性和方法。</p>
<p>对象<strong>proto</strong>属性的值就是它所对应的原型对象；</p>
<p>使用<strong>proto</strong>是有争议的，而且是不鼓励的。 它从来没有被包括在EcmaScript语言规范中，但是现代浏览器实现了它, 无论如何。<strong>proto</strong>属性已在ECMAScript 6语言规范中标准化，用于确保Web浏览器的兼容性，因此它未来将被支持。它已被不推荐使用, 建议使用Object.getPrototyOf()</p>
<h1 id="参考文章："><a href="#参考文章：" class="headerlink" title="参考文章："></a>参考文章：</h1><p>参考一： JS重点整理之JS原型链彻底搞清楚</p>
<p>参考二： 三张图搞懂JavaScript的原型对象与原型链</p>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>Q：prototype和<em>proto</em>区别</p>
<p>A：所有的函数对象都有一个prototype属性，这个属性引用了一个对象，即原型对象，也称原型。 然而普通对象是没有prototype属性，只有<em>proto</em>属性</p>
<p>Q：constructor 代表什么</p>
<p>A：constructor 属性返回对创建此对象的数组函数的引用</p>
<p>Q:<em>proto</em>的指向哪里</p>
<p>A:<em>proto</em>的指向取决于对象创建时的实现方式</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2017-12-26 10:28</i></div></article><article><a class="title" href="/2017/12/19/angular_双向绑定/">angularjs双向绑定后，发生了什么事情？view层和controller层是如何进行绑定的？</a><div class="content ellipse"><p></p><h1 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h1><p>双向绑定，是从界面的操作能实时反映到数据，数据的变更也能</p>
<p>实时展现到界面</p>
<h2 id="如何绑定"><a href="#如何绑定" class="headerlink" title="如何绑定"></a>如何绑定</h2><p>如果我们自己实现双向数据绑定该怎么写？</p>
<h2 id="如何实现"><a href="#如何实现" class="headerlink" title="如何实现"></a>如何实现</h2><p>angular是一个MVVM（Model-View，View-Model）模式的框架。</p>
<p>MVC:View传送指令到Controller；Controller完成业务逻辑后，要求Model改变状态；</p>
<p>Model将新的数据发送到View；所有通信都是单向的</p>
<p>MVVM它采用双向绑定：View的变动，自动反映在ViewModel，反之亦然。</p>
<p>View是angularjs编译html后呈现出来的，需要编译的是controller中的定义的属性和方法以及directive中定义的指令。</p>
<p>View和controller是独立开来的，他们之间的纽带就是scope。Controller负责向scope中提供属性和方法，</p>
<p>便于和view层面的html进行交互。</p>
<p>Angular双向绑定通过$watch,$digest，$apply实现的。</p>
<blockquote>
<p>watch序列</p>
</blockquote>
<p>watch监控model中是否有变化，会记录last值，也就是改变后的值，每一个model都会增加一个watch到watch队列中。</p>
<blockquote>
<p>digest循环</p>
</blockquote>
<p>当浏览器接收到可以被angular context处理的事件时，$digest循环就会触发，这个循环有两个子循环，</p>
<p>一个处理evalAsync队列，另一个处理watch队列，$digest会遍历$watch</p>
<p>既然所有的$watch都检查完了，那就要问了：有没有$watch更新过？如果有至少一个更新过，这个循环就会再次触发，</p>
<p>直到所有的$watch都没有变化。这样就能够保证每个model都已经不会再变化。记住如果循环超过10次的话，</p>
<p>它将会抛出一个异常，防止无限循环。 当$digest循环结束时，DOM相应地变化。</p>
<p>每一个进入angular context的事件都会执行一个$digest循环，也就是说每次我们输入一个字母循环都会检查整个页面的所有$watch。</p>
<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><p>$digest和$apply有何区别？干嘛不直接使用$digest?</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>这里值虽然改变了，但是没有强制执行$degest,watch根本没有执行</p>
<p>一般带ng的事件angular都会给你自动添加好了apply，但是你要操纵事件的时候加上apply才能实现数据输出到view层中。</p>
<p>为什么在ng-click里面调用$digest的话，会报错呢？因为Angular的设计，同一时间只允许一个$digest运行，</p>
<p>而ng-click这种内置指令已经触发了$digest，当前的还没有走完，所以就出错了</p>
<p>当你传入一个function到$apply()中的时候，这个function会被包装到一个try…catch块中，所以一旦有异常发生，</p>
<p>该异常会被$exceptionHandler service处理。</p>
<p>1.$apply可以带参数，它可以接受一个函数，然后在应用数据之后，调用这个函数。</p>
<p>2.当调用$digest的时候，只触发当前作用域和它的子作用域上的监控，但是当调用$apply的时候，会触发作用域树上的所有监控。</p>
<h1 id="更多讨论"><a href="#更多讨论" class="headerlink" title="更多讨论"></a>更多讨论</h1><p>Q、angular是什么框架</p>
<p>A、angular是一个MVVM（Model-View，View-Model）模式的框架</p>
<p>Q、为什么在ng-click里面调用$digest的话，会报错呢</p>
<p>A、因为Angular的设计，同一时间只允许一个$digest运行，</p>
<p>而ng-click这种内置指令已经触发了$digest，当前的还没有走完，所以就出错了</p>
<p>Q、$digest和$apply有何区别</p>
<p>A、1.$apply可以带参数，它可以接受一个函数，然后在应用数据之后，调用这个函数。</p>
<p>2.当调用$digest的时候，只触发当前作用域和它的子作用域上的监控，但是当调用$apply的时候，会触发作用域树上的所有监控。</p>
<p>7.参考文献</p>
<p><a href="http://www.cnblogs.com/bigdataZJ/p/AngularjsInAction2.html" target="_blank" rel="noopener">http://www.cnblogs.com/bigdataZJ/p/AngularjsInAction2.html</a> view和controller的那些事儿</p>
<p><a href="https://github.com/xufei/blog/issues/10" target="_blank" rel="noopener">https://github.com/xufei/blog/issues/10</a>  Angular沉思录（一）数据绑定</p>
<p><a href="http://www.angularjs.cn/A0a6理解$watch，$apply和$digest" target="_blank" rel="noopener">http://www.angularjs.cn/A0a6理解$watch，$apply和$digest</a> —理解数据绑定过程</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2017-12-19 20:29</i></div></article><article><a class="title" href="/2017/12/01/Nginx_反向代理跨域/">Nginx的反向代理跨域</a><div class="content ellipse"><p></p><h1 id="什么是跨域？"><a href="#什么是跨域？" class="headerlink" title="什么是跨域？"></a>什么是跨域？</h1><p>跨域是指a页面想获取b页面资源，如果a、b页面的协议、域名、端口、子域名不同，或是a页面为ip地址， b页面为域名地址，所进行的访问行动都是跨域</p>
<h1 id="产生的原因？"><a href="#产生的原因？" class="headerlink" title="产生的原因？"></a>产生的原因？</h1><p>浏览器为了安全问题一般都限制了跨域访问，也就是不允许跨域请求资源</p>
<p>同ip（或domain）,同端口，同协议视为同一个域，一个域内的脚本仅仅具有本域内的权限，可以理解为本域脚本只能读写 本域内的资源，而无法访问其它域的资源。这种安全限制称为同源策略</p>
<p>现代浏览器在安全性和可用性之间选择了一个平衡点。 在遵循同源策略的基础上，选择性地为同源策略“开放了后门”。例如img script style等标签，都允许垮域引用资源,然而， 你也只能是引用这些资源而已，并不能读取这些资源的内容</p>
<h2 id="同源策略限制以下几种行为："><a href="#同源策略限制以下几种行为：" class="headerlink" title="同源策略限制以下几种行为："></a>同源策略限制以下几种行为：</h2><p>1.Cookie、LocalStorage 和 IndexDB 无法读取</p>
<p>2.DOM 和 Js对象无法获得</p>
<p>3.AJAX 请求不能发送</p>
<h2 id="常见跨域场景"><a href="#常见跨域场景" class="headerlink" title="常见跨域场景"></a>常见跨域场景</h2><p><a href="http://www.domain.com/a.jshttp://www.domain.com/b.js" target="_blank" rel="noopener">http://www.domain.com/a.jshttp://www.domain.com/b.js</a> 同一域名，不同文件或路径 允许<a href="http://www.domain.com/lab/c.jshttp://www.domain.com:8000/a.jshttp://www.domain.com/b.js" target="_blank" rel="noopener">http://www.domain.com/lab/c.jshttp://www.domain.com:8000/a.jshttp://www.domain.com/b.js</a> 同一域名，不同端口 不允许<a href="http://www.domain.com/a.jshttps://www.domain.com/b.js" target="_blank" rel="noopener">http://www.domain.com/a.jshttps://www.domain.com/b.js</a> 同一域名，不同协议 不允许<a href="http://www.domain.com/a.jshttp://192.168.4.12/b.js" target="_blank" rel="noopener">http://www.domain.com/a.jshttp://192.168.4.12/b.js</a> 域名和域名对应相同ip 不允许<a href="http://www.domain.com/a.jshttp://x.domain.com/b.js" target="_blank" rel="noopener">http://www.domain.com/a.jshttp://x.domain.com/b.js</a> 主域相同，子域不同 不允许<a href="http://domain.com/c.jshttp://www.domain1.com/a.jshttp://www.domain2.com/b.js" target="_blank" rel="noopener">http://domain.com/c.jshttp://www.domain1.com/a.jshttp://www.domain2.com/b.js</a> 不同域名 不允许</p>
<h1 id="跨域解决方案"><a href="#跨域解决方案" class="headerlink" title="跨域解决方案"></a>跨域解决方案</h1><p>1、 通过jsonp跨域</p>
<p>2、 document.domain + iframe跨域</p>
<p>3、 location.hash + iframe</p>
<p>4、 window.name + iframe跨域</p>
<p>5、 postMessage跨域</p>
<p>6、 跨域资源共享（CORS）</p>
<p>7、 nginx代理跨域</p>
<p>8、 nodejs中间件代理跨域</p>
<p>9、 WebSocket协议跨域</p>
<h1 id="nginx反向代理解决跨域"><a href="#nginx反向代理解决跨域" class="headerlink" title="nginx反向代理解决跨域"></a>nginx反向代理解决跨域</h1><p>正向代理：代理位于网站和客户端中间， 客户端无法访问某网站，就将请求发送给代理服务器，代理从网站取回来再发送给客户端，网站并不知道为谁提供服务</p>
<p>反向代理：客户端访问某网站的一个页面， 但是网站并没有，就偷偷从另外一台服务器上取回来,然后作为自己的内容吐给用户，用户不知道真正提供服务的是谁</p>
<p>对于浏览器来说，访问的就是同源服务器上的一个url。而nginx通过 检测url前缀，把http请求转发到后面真实的物理服务器。并通过rewrite命令把前缀再去掉。这样真实的服务器就可以正确 处理请求，并且并不知道这个请求是来自代理服务器的。</p>
<p>简单说，nginx服务器欺骗了浏览器，让它认为这是同源调用，从而解决了浏览器的跨域问题。又通过重写url，欺骗了真实 的服务器，让它以为这个http请求是直接来自与用户浏览器的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Location/carrots-admin-ajax/&#123;</span><br><span class="line"></span><br><span class="line">  proxy_passhttp://dev.admin.carrots.ptteng.com/;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="proxy-pass把请求代理到其他主机"><a href="#proxy-pass把请求代理到其他主机" class="headerlink" title="proxy_pass把请求代理到其他主机"></a>proxy_pass把请求代理到其他主机</h2><p>两种写法h<a href="http://dev.admin.carrots.ptteng.com/" target="_blank" rel="noopener">http://dev.admin.carrots.ptteng.com/</a>  和  <a href="http://dev.admin.carrots.ptteng.com" target="_blank" rel="noopener">http://dev.admin.carrots.ptteng.com</a></p>
<p>如果访问url=<a href="http://server/html/test.jsp，则被nginx代理后" target="_blank" rel="noopener">http://server/html/test.jsp，则被nginx代理后</a></p>
<p>  情况1: 将test/作为根路径，请求test/路径下的资源。</p>
<p>  情况2: 则被nginx代理后，请求路径会变为<a href="http://proxy_pass/test.jsp，直接访问server的根资源。" target="_blank" rel="noopener">http://proxy_pass/test.jsp，直接访问server的根资源。</a></p>
<h2 id="carrots-admin-ajax"><a href="#carrots-admin-ajax" class="headerlink" title="/carrots-admin-ajax/"></a>/carrots-admin-ajax/</h2><p>是一个匹配规则，用于拦截请求，匹配任何以/proxy/html/开头的地址，匹配符合以后，停止往下搜索正则。</p>
<p>对于浏览器来说，访问的就是同源服务器上的一个url。而nginx通过检测url前缀，把http请求转发到后面真实的物理服务器。并通过rewrite命令把前缀再去掉。这样真实的服务器就可以正确处理请求，并且并不知道这个请求是来自代理服务器的。</p>
<p>简单说，nginx服务器欺骗了浏览器，让它认为这是同源调用，从而解决了浏览器的跨域问题。又通过重写url，欺骗了真实的服务器，让它以为这个http请求是直接来自与用户浏览器的。</p>
<h2 id="nginx-rewrite指令执行顺序："><a href="#nginx-rewrite指令执行顺序：" class="headerlink" title="nginx rewrite指令执行顺序："></a>nginx rewrite指令执行顺序：</h2><p>1.执行server块的rewrite指令(这里的块指的是server关键字后{}包围的区域，其它xx块类似)</p>
<p>2.执行location匹配</p>
<p>3.执行选定的location中的rewrite指令</p>
<p>如果其中某步URI被重写，则重新循环执行1-3，直到找到真实存在的文件</p>
<p>如果循环超过10次，则返回500 Internal Server Error错误</p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p>参考一：<a href="https://www.cnblogs.com/gabrielchen/p/5066120.html" target="_blank" rel="noopener">https://www.cnblogs.com/gabrielchen/p/5066120.html</a></p>
<p>参考二：<a href="http://blog.csdn.net/shendl/article/details/48443299" target="_blank" rel="noopener">http://blog.csdn.net/shendl/article/details/48443299</a></p>
<h1 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h1><p>Q：例如img script style等标签，都允许垮域引用资源？</p>
<p>A：在浏览器中，并且加载的方式其实相当于一次普通的GET请求，唯一不同的是，为了安全起见，浏览器不允许这种方式下对加载到的资源的读写操作，而只能使用标签本身应当具备的能力（比如脚本执行、样式应用等等）。</p>
<p>Q：JSONP和nginx跨域有什么不同</p>
<p>JSONP和nginx是完全不同的 是可以跨域的，而且在跨域脚本中可以直接回调当前脚本的函数</p>
<p>原理：是可以跨域的，而且在跨域脚本中可以直接回调当前脚本的函数</p>
<p>script标签是可以加载异域的JavaScript并执行的，通过预先设定好的callback函数来实现和母页面的交互。它有一个大名，叫做JSONP跨域，JSONP是JSON with Padding的略称。它是一个非官方的协议，明明是加载script，为啥和JSON扯上关系呢？原来就是这个callback函数，对它的使用有一个典型的方式，就是通过JSON来传参，即将JSON数据填充进回调函数，这就是JSONP的JSON+Padding的含义。JSONP只支持GET请求。</p>
<p>欢迎留言交流  (´▽`ʃ♡ƪ)</p>
<p></p></div><div class="meta"><i class="iconfont iconshijian1">2017-12-01 10:20</i></div></article><div id="paginator"><a class="extend prev" rel="prev" href="/archives/page/3/">Prev</a><a class="page-number" href="/archives/">1</a><a class="page-number" href="/archives/page/2/">2</a><a class="page-number" href="/archives/page/3/">3</a><span class="page-number current">4</span></div></div><script>document.getElementById('arshow').onclick = function() {
    document.getElementById('list_archives').style = 'opacity: 0;display: none'
    document.getElementById('normalposts').style = 'opacity: 0;display: block'
    setTimeout(() => {
        document.getElementById('normalposts').style.opacity = '1'                        
    }, 100);
}
document.getElementById('poshow').onclick = function() {
    document.getElementById('normalposts').style = 'opacity: 0;display: none'
    document.getElementById('list_archives').style = 'opacity: 1;display: block'
}</script></div></div></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>var _hmt = _hmt || [];(function(){var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?a4d08c5088ca0d4b18c14260c9ca89a1";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})()</script></body></html>